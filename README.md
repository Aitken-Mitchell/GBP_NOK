# GBP to NOK Exchange Rate Prediction

This project uses an LSTM neural network to predict GBP to NOK exchange rates based on historical financial data. The model incorporates multiple economic indicators such as oil prices, FTSE index, and central bank interest rates to improve predictive accuracy.

## üìå Features
- Fetches and preprocesses exchange rate data from Yahoo Finance.
- Incorporates Brent and WTI oil prices, FTSE 100 index, Norges Bank, and Bank of England interest rates.
- Implements technical indicators such as Moving Averages, RSI, and Bollinger Bands.
- Uses an LSTM-based deep learning model for time-series forecasting.
- Visualizes actual vs. predicted exchange rates and model performance metrics.

## üìÇ Project Structure
```
GBP_NOK_LSTM/
‚îÇ-- data_fetcher.py     # Script to fetch and preprocess data
|-- train_data.csv      # File generated by data_fetcher.py and used to train LSTM model (90% of all fetched data from 2007-12-06* until today)
|-- test_data.csv       # File generated by data_fetcher.py and used to test LSTM model (10% of all fetched data from the last day of data of the 90%)
‚îÇ-- forecast.py         # LSTM model training, evaluation, and forecasting
‚îÇ-- boe_policy_rate.csv # Bank of England rate data (local file), BOE doesn't provide an API. Note: file must be manually updated with new rates as and when.
‚îÇ-- requirements.txt    # Dependencies for the project
‚îÇ-- README.md           # Documentation
```
*2007-12-06 was chosen to avoid NaN values in boe_policy_rate.csv data. The Bank of England provides updates periodically and the data_fetcher.py program is designed to back-fill / forward-fill missing data. 2007-12-06 was a date the BOE provided an update.

## üöÄ Installation & Usage
### 1Ô∏è‚É£ Clone the Repository
```bash
git clone https://github.com/Aitken-Mitchell/GBP_NOK.git
cd GBP_NOK
```

### 2Ô∏è‚É£ Create and Activate a Conda Environment
**Info: the program was created to run on a GPU. To enable NVIDIA GPU to be used there is some script in forecast.py. The correct dependencies of cuDNN, CUDAtoolkit and TensorFlow as well as Python must be installed together for compatibility.**
```bash
conda create --name tf_gpu python=3.9
conda activate tf_gpu
```

### 3Ô∏è‚É£ Install Dependencies
```bash
pip install -r requirements.txt
```

### 4Ô∏è‚É£ Obtain API Access
This project fetches data from Yahoo Finance and Norges Bank. Some APIs may require authentication:
- Yahoo Finance (`yfinance`) does not require an API key.
- Norges Bank requires access to their public API.
- Ensure `boe_policy_rate.csv` is correctly placed in the project directory.

### 5Ô∏è‚É£ Run Data Fetching & Processing
```bash
python data_fetcher.py
```
This script downloads exchange rates, oil prices, FTSE index, and central bank rates, then merges and preprocesses them intotwo files: 'train_data.csv' & 'test_data.csv'.

### 6Ô∏è‚É£ Train & Forecast Using LSTM
```bash
python forecast.py
```
This trains the LSTM model and outputs exchange rate predictions along with performance metrics.

## üìä Results
- The script generates predicted exchange rates alongside actual values.
- It plots loss metrics (MSE, MAE, RMSE) and actual vs predicted exchange rates.
- A CSV file `Predicted_vs_Actual.csv` is created for further analysis.

## üõ†Ô∏è Troubleshooting
- Ensure TensorFlow detects your GPU:
  ```bash
  python -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"
  ```
- If missing dependencies, reinstall:
  ```bash
  pip install -r requirements.txt
  ```
- If any API requests fail, verify internet connectivity and API key permissions.

## üìú License
This project is licensed under the MIT License.

